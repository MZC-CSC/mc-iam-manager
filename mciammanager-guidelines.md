 # MC-IAM-MANAGER 개발 가이드라인
- 참조 project : https://github.com/m-cmp/mc-iam-manager 
- 참조 project의 기능을 재현.

## 1. 프로젝트 개요
- Keycloak 기반의 백엔드 서비스 개발
- 사용자, 권한, 역할 관리 기능 구현
- RESTful API 설계 및 구현

## 2. 기술 스택
- Go 1.21
- Echo Framework v4
- PostgreSQL
- Keycloak
- Docker & Docker Compose
- Swagger/OpenAPI

## 3. 프로젝트 구조
```
.
├── asset/
│   ├── menu/         # 메뉴
│   ├── sql/         # sql
│   ├── uml/         # uml
├── dockerfiles/    # Docker 관련 파일
│   ├── keycloak/         # keycloak
│   ├── mc-iam-manager/         # mc-iam-manager by src
│   ├── nginx/         # nginx
│   ├── postgres/         # postgres
├── src/
│   ├── config/         # 설정 관련 코드
│   ├── handler/        # HTTP 요청 처리
│   ├── middleware/     # 미들웨어
│   ├── model/         # 데이터 모델
│   ├── repository/    # 데이터베이스 작업
│   ├── service/       # 비즈니스 로직
│   └── main.go        # 애플리케이션 진입점
├── migrations/        # 데이터베이스 마이그레이션
├── docs/             # API 문서
└── docker/           # Docker 관련 파일
```

## 4. 개발 단계

### 4.1 초기 설정
1. 환경 변수 설정
   - `.env` 파일 생성
   - 필요한 환경 변수 정의
   - 데이터베이스 연결 정보 설정
   - Keycloak 설정 정보 추가

2. 데이터베이스 설정
   - PostgreSQL 컨테이너 실행
   - 마이그레이션 실행
   - 초기 데이터 설정

3. Keycloak 설정
   - Keycloak 컨테이너 실행
   - Realm 생성
   - 클라이언트 설정
   - 사용자 및 역할 설정

### 4.2 핵심 기능 구현

#### 4.2.1 사용자 관리
- 사용자 CRUD API 구현
- 사용자 검색 기능
- 사용자 상태 관리
- 비밀번호 정책 적용

#### 4.2.2 역할 관리
- 플랫폼 역할 관리
- 워크스페이스 역할 관리
- 역할 기반 접근 제어
- 역할 계층 구조 구현

#### 4.2.3 권한 관리
- 권한 CRUD API 구현
- 권한 할당/제거
- 권한 검증
- 권한 그룹화

### 4.3 API 문서화
- Swagger/OpenAPI 문서 작성
- API 엔드포인트 설명
- 요청/응답 예제
- 에러 코드 정의

## 5. 코딩 표준

### 5.1 일반 규칙
- Go 코드 스타일 가이드 준수
- 의미 있는 변수명과 함수명 사용
- 적절한 주석 작성
- 에러 처리 일관성 유지

### 5.2 패키지 구조
- 단일 책임 원칙 준수
- 의존성 주입 사용
- 인터페이스 기반 설계
- 모듈화된 구조 유지

### 5.3 테스트
- 단위 테스트 작성
- 테스트 커버리지 유지
- 테스트 케이스 문서화
- CI/CD 파이프라인 통합

## 6. 보안 가이드라인

### 6.1 인증
- JWT 토큰 사용
- 토큰 갱신 메커니즘
- 세션 관리
- 로그아웃 처리

### 6.2 권한
- RBAC (Role-Based Access Control) 구현
- 최소 권한 원칙 적용
- 권한 검증 미들웨어
- 감사 로그 기록

### 6.3 데이터 보안
- 민감한 데이터 암호화
- SQL 인젝션 방지
- XSS 방지
- CSRF 보호

## 7. 배포 가이드라인

### 7.1 Docker 배포
- 멀티 스테이지 빌드
- 최적화된 이미지 크기
- 환경별 설정 관리
- 볼륨 마운트 설정

### 7.2 모니터링
- 로깅 설정
- 메트릭 수집
- 알림 설정
- 성능 모니터링

### 7.3 백업 및 복구
- 데이터베이스 백업
- 설정 백업
- 복구 절차
- 장애 대응 계획

## 8. 유지보수 가이드라인

### 8.1 버전 관리
- 시맨틱 버저닝 사용
- 변경 로그 관리
- 브랜치 전략
- 릴리스 프로세스

### 8.2 문서화
- API 문서 유지보수
- 코드 문서화
- 운영 문서
- 문제 해결 가이드

### 8.3 성능 최적화
- 쿼리 최적화
- 캐싱 전략
- 리소스 사용 최적화
- 부하 테스트