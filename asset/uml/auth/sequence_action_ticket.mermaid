sequenceDiagram
    participant Client
    participant Router as main.go (Echo)
    participant AuthMiddleware as middleware.AuthMiddleware
    participant AuthHandler as handler.AuthHandler
    participant KeycloakService as service.KeycloakService
    participant Keycloak

    Client->>+Router: POST /api/auth/action-ticket (Body: WorkspaceTicketRequest, Header: Bearer AccessToken)
    Router->>+AuthMiddleware: Verify Access Token
    AuthMiddleware-->>-Router: Token OK (Set User Info)
    Router->>+AuthHandler: ActionTicket(c) %% Assuming handler renamed from WorkspaceTicket
    AuthHandler->>AuthHandler: Extract AccessToken from Header
    AuthHandler->>AuthHandler: Bind Request Body (WorkspaceTicketRequest)
    AuthHandler->>AuthHandler: Prepare Permissions (string slice)
    AuthHandler->>AuthHandler: Prepare RequestingPartyTokenOptions
    AuthHandler->>+KeycloakService: GetRequestingPartyToken(ctx, accessToken, options)
    KeycloakService->>+Keycloak: Request RPT (UMA Token Endpoint)
    Keycloak-->>-KeycloakService: RPT (JWT) or Error
    KeycloakService-->>-AuthHandler: RPT or Error
    alt Error getting RPT
        AuthHandler-->>-Router: 403 or 500 Error
        Router-->>-Client: 403 or 500 Error
    else Success
        AuthHandler-->>-Router: 200 OK (RPT)
        Router-->>-Client: 200 OK (RPT)
    end
